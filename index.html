<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Neighborhood Map project - Alan Spiewak</title>
	<!-- Fonts from Google API, Twitter's Bootstrap from its recommended CDN -->
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css?family=Merriweather:400,300,400italic,700,900">
	<link rel="stylesheet"
		href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="style.css">

</head> <!--  -->
<body>
	<div class="container-fluid">
		<div class="row " id="welcomeRow">
			<div class="col-xs-12" id="welcome">
				<p>Welcome to <span id="headerPlace">Greensboro, NC</span></p>
			</div>
		</div> <!-- welcomeRow -->
		<div class="row" id="mapRow">
			<div class="col-xs-12 col-md-3" id="nmvList"> <!-- Col holds list view of places -->
				<!-- Row box sits inside the outer column and acts as container
					 for stacked full-width "columns" that look like rows and
					 hold the list header and items -->
				<div class="row" id="nmvListHeaderRow">
					<div class="col-xs-12" id="nmvListHead">
						<p>Places to show</p>
						<div style="display: flex; justify-content: center">
						<!-- Button code is from
							 http://getbootstrap.com/components/#btn-groups -->
						<div class="btn-group" role="filterControl">
							<button type="button" class="btn btn-default"
								data-bind="click: btnDispSaved">
								Pinned only
							</button>

							<div class="btn-group" role="group">
							    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							      Filter
							      <span class="caret"></span>
							    </button>
							    <ul class="dropdown-menu">
							    	<li class="dropdown-header">Which category do you want to view?</li>
									<div data-bind="foreach: filterCategories">
								      <li class="filterLine"><a><span  data-bind="click: $root.btnFilter"><img data-bind="attr: {src: iconSrc}" class="filterImg"><span data-bind="text: label"> </span></span></a></li>
								    </div>
							    </ul>
							  </div> <!-- btn-group -->

							<button type="button" class="btn btn-default"
								data-bind="click: btnFind">
								Find new
							</button>
						</div> <!--filterControl -->
						</div> <!-- style flex -->
					</div> <!-- #nmvListHead -->
				</div> <!-- #nmvListHeaderRow -->
				<div class="row" id="listBodyRow" data-bind="foreach: vPlaces">
					<!-- List item row is bound to a vPlace entry.
					Tooltip handling is adapted from
					http://www.w3schools.com/bootstrap/bootstrap_tooltip.asp
					-->
					<div class="col-xs-12 nmvListItem"
					data-bind="visible: display, css: { highlight: hilite() == true }">
						<div data-bind="click: nmApp.viewModel.listItemClick"
						class="listText" title="Select/deselect this place to see more">
							<p class="listItemName" data-bind="text: name"></p>
							<p class="listItemaddress" data-bind="text: address"></p>
						</div>
						<button class="pinnedBtn"
						data-bind="text: pinned() ? 'Pinned' : 'Unpinned',
						click: nmApp.viewModel.pinnedClick"
						title="Pin/unpin this place to/from your list"></button>
						<button class="detailBtn" type="button"
							title="Show place details"
							data-bind="click: $root.openModal, visible: isCurrent">
							More
						</button>
					</div> <!-- .nmvListItem -->
				</div> <!-- #listBodyRow -->
			</div> <!-- #nmvList -->
			<div class="col-xs-12 col-md-9" id="nmvMap"> <!-- Map view -->
				<p>Map goes here</p>
			</div> <!-- nmvMap -->
		</div> <!-- mapRow -->
	</div> <!-- container-fluid -->
	<!-- Modal window for selected vPlace. Knockout and Bootstrap don't play
		 nice on data binding for modals, so this DIY solution is from
		 http://www.w3schools.com/howto/howto_css_modals.asp
		 Class names have been changed to protect us from bootstrap presets-->
	<div class="nmModal" role="dialog" id="placeDetails" data-bind="click: $root.closeModal">
		<div class="nmModalContent" data-bind="with: currentVPlace,
			click: $root.noOp,  clickBubble: false">
			<div class="nmModalHeader">
				<button type="button" class="modalCloseBtn" aria-hidden="true"
				data-bind="click: $root.closeModal">
				&times;</button>
				<h3>Details for <span data-bind="text: name"></span>,
					&nbsp;<span data-bind="text: address"></span>
					</h3>
			</div>
			<div class="nmModalBody container-fluid">
				<div class="row">
					<div class="gDetails col-xs-12 col-md-6" data-bind="with: gDetails">
						<h4>
							<img alt="Google logo" height="40"
							src="https://www.google.com/images/branding/product/2x/maps_48dp.png">
							Data source: Google Maps
						</h4>
						<div class="modalScrollRow" data-bind="foreach: photos">
							<a data-toggle="popover"
								data-html="true"
								data-content="Hello"
								tabindex="0"
								role="button"
								data-trigger="focus"
								title="Photo credit"
								>
								<img data-bind="attr: {src: getUrl({maxHeight:150})}"
									title="Click for photo credit" alt="Image from Google Places">
							</a>
						</div> <!-- modalPhotoRow -->
						<p class="gdItem"><br>Google rating:&nbsp;
							<span class="gdItemVal" data-bind="text: rating"></span> out of 5
						</p>
						<p class="gdItem">Full address:&nbsp;
							<span class="gdItemVal" data-bind="text: formattedAddress"></span>
						</p>
						<p class="gdItem">Phone:&nbsp;
							<span class="gdItemVal" data-bind="text: formattedPhoneNumber"></span>
						</p>
						<p><table class="gdItem">
							<thead>
								<tr><th>Hours of operation:<th><tr>
							</thead>
							<tbody data-bind="foreach: weekdayText">
								<tr><td class="gdIndent" data-bind="text: hours">
								</td><tr>
							</tbody>
						</table></p>
						<p class="gdItem">Price level:&nbsp;
							<span class="gdItemVal" data-bind="text: priceLevel"></span>
						</p>
						<p class="gdItem">Web site:&nbsp;
							<a class="gdItemVal"
							data-bind="text: website, attr: {href: website}, click: $root.noOp" target="_blank"></a>
						</p>
						<div class="modalScrollRow" data-bind="foreach: reviews">
							<p class="gdItem">Review by&nbsp;
								<a data-bind="text: author_name, attr: {href: author_url}, click: $root.noOp"
									target="_blank"></a>
								:&nbsp;<span data-bind="text: rating"></span> out of 5
								<br><span class="gdIndent" data-bind="text: text"
							</p>
						</div>



						<p class="gdItem">
							<a data-bind="attr: {href: gmapsUrl}, click: $root.noOp" target="_blank">View with Google Maps</a>
						</p>
					</div> <!-- gDetails -->
					<div class="yDetails col-xs-12 col-md-6" data-bind="with: yDetails">
						<h4>
							<a target="_blank" href="https://www.yelp.com/greensboro-nc-us">
								<img alt="Yelp logo" height="40" class="logo"
								src="https://s3-media2.fl.yelpcdn.com/assets/srv0/developer_pages/9b78de2c2ec9/assets/img/logo-2-color.png">
							</a>
							Data source: Yelp
						</h4>
						<div class="modalPhotoRow">
							<img data-bind="attr: {src: photo}" alt="Image from Yelp" height="150">
						</div> <!-- modalPhotoRow -->
						<p class="gdItem"><br>Yelp rating:&nbsp;
							<span class="gdItemVal" data-bind="text: rating"></span>&nbsp;
							<img data-bind="attr: {src: ratingImg}" alt="">&nbsp;
							<span data-bind="text: reviewCount"></span> reviews
						</p>
						<p class="gdItem">Name:&nbsp;
							<span class="gdItemVal" data-bind="text: name"></span>
						</p>
						<p class="gdItem">Full address:&nbsp;
							<span class="gdItemVal" data-bind="text: address"></span>
						</p>
						<p class="gdItem">Phone:&nbsp;
							<span class="gdItemVal" data-bind="text: phone"></span>
						</p>
						<p class="gdItem">Featured quote:&nbsp;
							<span class="gdItemVal" data-bind="text: snippet"></span>
						</p>
						<p class="gdItem">
							<a data-bind="attr: {href: yelpUrl}, click: $root.noOp" target="_blank">
								View with Yelp
							</a>
						</p>
					</div> <!-- yDetails -->
				</div> <!-- row -->
			</div> <!-- nmModalBody -->
			<div class="nmModalFooter">
				<button type="button" class="btn btn-default modalPinBtn"
					data-bind="text: pinned() ? 'Pinned' : 'Unpinned',
					click: nmApp.viewModel.pinnedClick"></button>
			</div> <!-- nmModalFooter -->
		</div> <!-- nmModalContent -->
	</div> <!-- .nmModal -->

	<!-- Input box for place searches. CSS sets initial display to 'none'.
		 Function view.initMap() puts the control on our map (still hidden) to be
		 displayed and used by Find processing. -->
	<input id="findBox" type="text" placeholder="Please enter a name or keyword to search">

	<!-- jQuery and Knockout libraries from CDNJS via Cloudflare's CDN.
		 Both are required to render the page, so we can't defer their load -->
	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js"></script>
	<script async defer src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<!-- Two scripts for OAuth validation in the Yelp API. -->
	<script async defer src="js/oauth.js"></script>
	<script async defer src="http://pajhome.org.uk/crypt/md5/sha1.js"></script>

	<!-- This application's processing is contained in the nmApp (neighborhood
		map application) object, which contains objects that define its Model,
		View, and ViewModel objects. nmViewModel.js contains constructors that
		rely on loading nmModel.js first. -->
	<!-- 	 TODO Minify and consolidate these four scripts -->
	<script type="text/javascript" src="js/nmApp.js"></script>
	<script type="text/javascript" src="js/nmModel.js"></script>
	<script type="text/javascript" src="js/nmView.js"></script>
	<script type="text/javascript" src="js/nmViewModel.js"></script>

	<!-- Initialize Google Maps libraries. Note: must follow nmView.js and
		 nmApp.viewModel. The callback here kicks off the entire application. -->
	<script async defer
    src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyD4TqIPvv-WwDSy7TCEeHufsQtVPws6XJs&callback=nmApp.viewModel.init"></script>
</body>
