<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Neighborhood Map project - Alan Spiewak</title>
	<!-- Fonts from Google API, Twitter's Bootstrap from its recommended CDN -->
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css?family=Merriweather:400,300,400italic,700,900">
	<link rel="stylesheet"
		href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="style.css">

</head> <!--  -->
<body>
	<div class="container-fluid">
		<div class="row " id="welcomeRow">
			<div class="col-xs-12" id="welcome">
				<p>Welcome to <span id="headerPlace">Greensboro, NC</span></p>
				<input type="image" class="helpBtn"
					title="Show help screen" src="question-mark-4-48.png"
					data-toggle="modal" data-target="#helpModal" />
			</div>
		</div> <!-- welcomeRow -->
		<div class="row" id="mapRow">
			<div class="col-xs-12 col-md-8" id="nmvMap"> <!-- Map view -->
				<p>Map goes here</p>
			</div> <!-- nmvMap -->
			<div class="col-xs-12 col-md-4" id="nmvList"> <!-- Col holds list view of places -->
				<!-- Row box sits inside the outer column and acts as container
					 for stacked full-width "columns" that look like rows and
					 hold the list header and items -->
				<div class="row" id="nmvListHeaderRow">
					<div class="col-xs-12" id="nmvListHead">
						<p>Places to show</p>
						<div style="display: flex; justify-content: center">
						<!-- Button code is from
							 http://getbootstrap.com/components/#btn-groups -->
						<div class="btn-group" role="filterControl">
							<button type="button" class="btn btn-default"
								data-bind="click: btnDispSaved">
								Pinned only
							</button>

							<div class="btn-group" role="group">
							    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							      Filter
							      <span class="caret"></span>
							    </button>
							    <ul class="dropdown-menu">
							    	<li class="dropdown-header">Which category do you want to view?</li>
									<div data-bind="foreach: filterCategories">
								      <li class="filterLine"><a><span  data-bind="click: $root.btnFilter"><img data-bind="attr: {src: iconSrc}" class="filterImg"><span data-bind="text: label"> </span></span></a></li>
								    </div>
							    </ul>
							  </div> <!-- btn-group -->

							<button type="button" class="btn btn-default"
								data-bind="click: btnFind">
								Find new
							</button>
						</div> <!--filterControl -->
						</div> <!-- style flex -->
					</div> <!-- #nmvListHead -->
				</div> <!-- #nmvListHeaderRow -->
				<div class="row" id="listBodyRow" data-bind="foreach: vPlaces">
					<!-- List item row is bound to a vPlace entry.
					Tooltip handling is adapted from
					http://www.w3schools.com/bootstrap/bootstrap_tooltip.asp
					-->
					<div class="col-xs-12 nmvListItem"
					data-bind="visible: display, css: { highlight: hilite() == true }">
						<div data-bind="click: nmApp.viewModel.listItemClick"
						class="listText" title="Select/deselect this place to see more">
							<p class="listItemName" data-bind="text: name"></p>
							<p class="listItemaddress" data-bind="text: address"></p>
						</div>
						<input type="image" class="pinnedBtn" data-bind="click: nmApp.viewModel.pinnedClick, attr: { src: pinned() ? 'pin-48.png' : 'unpin-2-48.png' }"
						title="Pin/unpin this place on your list" />
						<input type="image" class="detailBtn"
							title="Show place details" src="info-2-48r.png"
							data-bind="click: $root.openModal, visible: isCurrent" />
					</div> <!-- .nmvListItem -->
				</div> <!-- #listBodyRow -->
			</div> <!-- #nmvList -->
		</div> <!-- mapRow -->
	</div> <!-- container-fluid -->
	<!-- Modal window for selected vPlace. Knockout and Bootstrap don't
		 play nice on data binding for modals, so this DIY solution is
		 from http://www.w3schools.com/howto/howto_css_modals.asp
		 Class names have been changed to protect us from bootstrap's class names (which are used below) -->
	<div class="nmModal" role="dialog" id="placeDetails" data-bind="click: $root.closeModal">
		<div class="nmModalContent" data-bind="with: currentVPlace,
			click: $root.noOp,  clickBubble: false">
			<div class="nmModalHeader">
				<button type="button" class="modalCloseBtn" aria-hidden="true"
				data-bind="click: $root.closeModal">
				&times;</button>
				<h3>Details for <span data-bind="text: name"></span>,
					&nbsp;<span data-bind="text: address"></span>
					</h3>
			</div>
			<div class="nmModalBody container-fluid">
				<div class="row">
					<div class="gDetails col-xs-12 col-md-6" data-bind="with: gDetails">
						<div class="row">
							<h4 class="col-xs-12 col-sm-8">
								<img alt="Google logo" height="40"
								src="https://www.google.com/images/branding/product/2x/maps_48dp.png">
								Data source: Google Maps
							</h4>
							<div class="col-xs-12 col-sm-4 modal-href">
								<a data-bind="attr: {href: gmapsUrl}, click: $root.noOp" target="_blank">
									View with Google Maps
								</a>
							</div>
						</div> <!-- row -->
						<div class="modalScrollRow" data-bind="foreach: photos">
							<a data-toggle="popover"
								data-html="true"
								data-content="Hello"
								tabindex="0"
								role="button"
								data-trigger="focus"
								title="Photo credit"
								>
								<img data-bind="attr: {src: getUrl({maxHeight:150})}"
									title="Click for photo credit"
									alt="Image from Google Places">
							</a>
						</div> <!-- modalPhotoRow -->
						<p class="gdItem"><br>Google rating:&nbsp;
							<span class="gdItemVal" data-bind="text: rating"></span> out of 5
						</p>
						<p class="gdItem">Full address:&nbsp;
							<span class="gdItemVal" data-bind="text: formattedAddress"></span>
						</p>
						<p class="gdItem">Phone:&nbsp;
							<span class="gdItemVal" data-bind="text: formattedPhoneNumber"></span>
						</p>
						<p><table class="gdItem">
							<thead>
								<tr><th>Hours of operation:<th><tr>
							</thead>
							<tbody data-bind="foreach: weekdayText">
								<tr><td class="gdIndent" data-bind="text: hours">
								</td><tr>
							</tbody>
						</table></p>
						<p class="gdItem">Price level:&nbsp;
							<span class="gdItemVal" data-bind="text: priceLevel"></span>
						</p>
						<p class="gdItem">Web site:&nbsp;
							<a class="gdItemVal"
							data-bind="text: website, attr: {href: website}, click: $root.noOp" target="_blank"></a>
						</p>
						<div class="modalScrollRow" data-bind="foreach: reviews">
							<p class="gdItem">Review by&nbsp;
								<a data-bind="text: author_name, attr: {href: author_url}, click: $root.noOp"
									target="_blank"></a>
								:&nbsp;<span data-bind="text: rating"></span> out of 5
								<br><span class="gdIndent" data-bind="text: text"
							</p>
						</div>

					</div> <!-- gDetails -->
					<div class="yDetails col-xs-12 col-md-6" data-bind="with: yDetails">
						<div class="row">
							<h4 class="col-xs-12 col-sm-8">
								<a target="_blank" href="https://www.yelp.com/greensboro-nc-us">
									<img alt="Yelp logo" height="40" class="logo"
									src="https://s3-media2.fl.yelpcdn.com/assets/srv0/developer_pages/9b78de2c2ec9/assets/img/logo-2-color.png">
								</a>
							Data source: Yelp
							</h4>
							<div class="col-xs-12 col-sm-4 modal-href">
								<a data-bind="attr: {href: yelpUrl}, click: $root.noOp" target="_blank">
									View with Yelp
								</a>
							</div>
						</div> <!--row -->
						<div class="modalPhotoRow">
							<img data-bind="attr: {src: photo}" alt="Image from Yelp" height="150">
						</div> <!-- modalPhotoRow -->
						<p class="gdItem"><br>Yelp rating:&nbsp;
							<span class="gdItemVal" data-bind="text: rating"></span>&nbsp;
							<img data-bind="attr: {src: ratingImg}" alt="">&nbsp;
							<span data-bind="text: reviewCount"></span> reviews
						</p>
						<p class="gdItem">Name:&nbsp;
							<span class="gdItemVal" data-bind="text: name"></span>
						</p>
						<p class="gdItem">Full address:&nbsp;
							<span class="gdItemVal" data-bind="text: address"></span>
						</p>
						<p class="gdItem">Phone:&nbsp;
							<span class="gdItemVal" data-bind="text: phone"></span>
						</p>
						<p class="gdItem">Featured quote:&nbsp;
							<span class="gdItemVal" data-bind="text: snippet"></span>
						</p>
						<p class="gdItem">

						</p>
					</div> <!-- yDetails -->
				</div> <!-- row -->
			</div> <!-- nmModalBody -->
			<div class="nmModalFooter">
				<button type="button" class="btn btn-default modalPinBtn"
					data-bind="text: pinned() ? 'Pinned' : 'Unpinned',
					click: nmApp.viewModel.pinnedClick" title="Pin/unpin this place on your list"></button>
			</div> <!-- nmModalFooter -->
		</div> <!-- nmModalContent -->
	</div> <!-- .nmModal -->


<!-- Modal -->
<div class="modal fade" id="helpModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="helpModalLabel">Welcome to the Neighborhood Map Project</h4>
      </div>
      <div class="modal-body nmModalBody">
      	<p>
      		Welcome to downtown Greensboro, North Carolina. In the years I’ve been here, our downtown has opened new establishments, seen run-down buildings rejuvenated and reused, and sprouted new parks and museums.
        </p><p>
			This web page is my chance to share some of my favorite spots downtown and to let you discover some other spots that appeal to you. When you first run the page I show you a set of places I’ve picked for you. There are some of my favorite spots (if they're old enough for complete entries in Yelp and Google Maps). I’ve also included a few places that most residents would know.
        </p><p>
			You will see a map of downtown at the left of your display or (on a mobile device) at the top. The places are marked with colored icons, one color for each category. To the right of (or below) the map, you’ll see a list of the places and their addresses. If you click on either the list entry or the map marker, it selects that place and “turns on” an icon that takes you to detailed information about the place (furnished by Google Maps and Yelp). Interested? You can click through to reviews, pictures, and more information from the two data sources. Or you can visit the place's own website. Too many places at once? Click on “Filter” and choose one category at a time to explore.
        </p><p>
			If you aren’t all that interested in one of my places, you can unpin it (there’s a button in the list item or at the bottom of the details window). If you want to look for more places, click on the “Find new” button at the top of the list. A box will appear on the map, and you can type in search items and see what Google has in store. If you find places you want to “collect,” just pin them and they will become a permanent part of your personal collection. To return to your personal collection, click on the “Pinned only” button and your collection will reappear.
        </p><p>
			When you close the page, the places you have pinned will be stored on your computer. The next time you come back, your set of places will be displayed, and you can continue your virtual exploration. Enjoy!
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
        	Close
        </button>
        <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#creditModal">
        	Credit attributions
        </button>
      </div>
    </div>
  </div>
</div>



<!-- Modal -->
<div class="modal fade" id="creditModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="helpModalLabel">Coding sources for this project</h4>
      </div>
      <div class="modal-body nmModalBody">
      	<p>
        She waited for some time without hearing anything more: at last came a rumbling of little cartwheels, and the sound of a good many voices all talking together: she made out the words: 'Where's the other ladder?—Why, I hadn't to bring but one; Bill's got the other—Bill! fetch it here, lad!—Here, put 'em up at this corner—No, tie 'em together first—they don't reach half high enough yet—Oh! they'll do well enough; don't be particular—Here, Bill! catch hold of this rope—Will the roof bear?—Mind that loose slate—Oh, it's coming down! Heads below!'
        </p><p>
		"I did not 'escape'," I replied. "I but ran away to avoid the thag, as did others, and coming into a long passage I became confused and lost my way in the foothills beyond Phutra. Only now have I found my way back." "And you come of your free will back to Phutra!" exclaimed one of the guardsmen. "Where else might I go?" I asked. "I am a stranger within Pellucidar and know no other where than Phutra. Why should I not desire to be in Phutra? Am I not well fed and well treated?
		</p><p>
		There were few or no bridges or tunnels on the route. The railway turned around the sides of the mountains, and did not attempt to violate nature by taking the shortest cut from one point to another. The train entered the State of Nevada through the Carson Valley about nine o'clock, going always northeasterly; and at midday reached Reno, where there was a delay of twenty minutes for breakfast. From this point the road, running along Humboldt River, passed northward for several miles by its banks; then it turned eastward, and kept by the river </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>




	<!-- Input box for place searches. Function view.initMap() puts the
		 control on our map and turns display off. It is displayed and
		 used in Find processing. -->
	<input id="findBox" type="text" placeholder="Please enter a name or keyword to search">

	<!-- jQuery and Knockout libraries from CDNJS via Cloudflare's CDN.
		 Both are required to render the page, so we can't defer their load -->
	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js"></script>
	<script async defer src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<!-- Two scripts for OAuth validation in the Yelp API. -->
	<script async defer src="js/oauth.js"></script>
	<script async defer src="http://pajhome.org.uk/crypt/md5/sha1.js"></script>

	<!-- This application's processing is contained in the nmApp (neighborhood
		map application) object, which contains objects that define its Model,
		View, and ViewModel objects. nmViewModel.js contains constructors that
		rely on loading nmModel.js first. -->
	<!-- 	 TODO Minify and consolidate these four scripts -->
	<script type="text/javascript" src="js/nmApp.js"></script>
	<script type="text/javascript" src="js/nmModel.js"></script>
	<script type="text/javascript" src="js/nmView.js"></script>
	<script type="text/javascript" src="js/nmViewModel.js"></script>

	<!-- Initialize Google Maps libraries. Note: must follow nmView.js and
		 nmApp.viewModel. The callback here kicks off the entire application. -->
	<script async defer
    src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyD4TqIPvv-WwDSy7TCEeHufsQtVPws6XJs&callback=nmApp.viewModel.init"></script>
</body>
